using SPICE

file = "pck00010.tpc"

ids = []
gms = []
re = r"BODY(?<id>[0-9]+)_GM\s+= \( (?<gm>[0-9\.\+\-E]+) \)"
lines = open(readlines, file)
for line in lines
    s = string(line)
    if occursin(re, s)
        m = match(re, s)
        push!(ids, parse(Int, m["id"]))
        # From km^3/s^2 to m^3/s^2
        push!(gms, parse(Float64, m["gm"]) * 1e9)
    end
end

open("pck.jl", "w") do f
    write(f, "# Automatically generated by $(basename(@__FILE__)), do not edit!\n\n")
    write(f, "grav_param(::SolarSystemBarycenter) = $(gms[findfirst(ids .== 10)])\n")
    for (id, gm) in zip(ids, gms)
        try
            body = replace(titlecase(bodc2n(id)), r"\s"=>"")
            body = body == "Moon" ? "Luna" : body
            write(f, "grav_param(::$body) = $gm\n")
        catch
            # pass
        end
    end
end
